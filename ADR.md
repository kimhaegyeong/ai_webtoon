# ADR — 아키텍처/설계 결정

> AI 릴레이 만화 | `docs/사전 개발 기획안.md` 기반 산출
>

## ADR-1: 프론트엔드 — React + Vite + Tailwind

- **결정**: SPA는 React 18+, 빌드 도구 Vite, 스타일링 Tailwind CSS.
- **이유**: 빠른 개발·반응형 세로 스트립 뷰 구현에 적합. 해커톤 기간 내 MVP에 집중.

## ADR-2: 백엔드·DB·Realtime — Supabase

- **결정**: PostgreSQL + Realtime + Storage를 Supabase 한 플랫폼으로 사용.
- **이유**: 인증 없이 익명 참여를 전제로 하며, 링크+닉네임만으로 참여. Realtime으로 턴/칸 반영을 즉시 구독 가능. RLS 또는 공개 읽기/쓰기 정책은 보안 요구에 따라 선택.

## ADR-3: 이미지 생성 — 나노 바나나

- **결정**: 만화 칸 1장당 **나노 바나나** 이미지 생성 API 1회 호출.
  프롬프트는 **스타일 prefix + 캐릭터 + 이전 칸 레퍼런스 + 현재 칸 내용** 순으로 조합한다.
- **이유**: 말풍선·대사·표음을 포함한 한 컷 생성에 적합. 레퍼런스 이미지로 캐릭터 일관성 유지.

## ADR-4: 스토리 자동완성 — 텍스트 LLM (추후 확정)

- **결정**: "AI에게 넘기기" 시 **스토리 생성용 텍스트 LLM**으로 남은 칸의 `{장면, 대사, 표음}`을 JSON으로 생성한 뒤,
  칸별로 나노 바나나를 호출해 이미지까지 완성한다.
- **이유**: 스토리 출력 형식을 구조화(JSON)하면 이후 파이프라인(이미지 생성/저장/Realtime 반영)이 단순해진다.
  (모델은 개발 단계에서 비용/속도/품질을 보고 확정)

## ADR-5: API 키·호출 위치

- **결정**: 나노 바나나/스토리 LLM API 키는 클라이언트에 노출하지 않고, 서버/Edge(Vercel API Routes 등)에서만 호출.
- **이유**: API 키 유출 방지. Vite env는 클라이언트 번들에 포함될 수 있으므로 서버 전용 변수 분리.

## ADR-8: 프롬프트 템플릿 관리

- **결정**: 스토리/이미지 프롬프트는 코드에 하드코딩하지 않고 `prompts/`의 템플릿 파일로 관리한다.
- **이유**: 프롬프트 품질 개선이 잦은 영역이므로, 프롬프트를 독립 산출물로 분리해 변경 이력/리뷰를 쉽게 한다.

## ADR-6: 배포 — Vercel

- **결정**: 프론트 + Serverless/Edge API는 Vercel 무료 티어로 배포.
- **이유**: Git 연동·프리뷰·환경 변수 관리 용이. 해커톤 데모 안정성.

## ADR-7: 데이터 모델 요약

- **episodes**: 스타일, 캐릭터 프롬프트, 제목/요약, 현재 턴 인덱스, 상태(draft | in_progress | completed).
- **participants**: 에피소드별 닉네임, 턴 순서(turn_order). 0 = 방장.
- **panels**: order_index, 장면/대사/표음/말풍선 위치, image_url(Storage), created_by. 좋아요는 panel_likes 등 별도 구조로 칸별 집계.

이 문서는 기획안 구체화 과정에서의 설계·아키텍처 결정을 기록한 것이며, 구현 시 추가 ADR이 생기면 번호를 이어 붙인다.
