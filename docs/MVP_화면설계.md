# AI 릴레이 만화 — MVP 화면 설계

> 기획안 §4.2 화면별 상세 기준으로 작성한 와이어프레임 + 플로우 문서입니다.

---

## 화면 목록

| ID  | 화면 이름          | 진입 조건                          |
|-----|--------------------|------------------------------------|
| S1  | 메인(랜딩)         | 최초 접속 `/`                      |
| S2  | 에피소드 생성      | S1 "새 만화 시작" 클릭             |
| S3  | 첫 칸 입력         | S2 완료 후 자동 전환               |
| S4  | 생성 중 로딩       | "생성" 버튼 클릭 시                |
| S5  | 콜라보 대기실      | S3 첫 칸 완성 후 / 링크로 닉네임 입력 후 |
| S6  | 닉네임 입력        | 공유 링크 `/c/{episodeId}` 진입   |
| S7  | AI 이어쓰기 확인   | "AI에게 넘기기" 클릭 (3칸 이상)   |
| S8  | 공유               | "지금 공유하기" 클릭               |
| S9  | 감상(뷰어)         | `/e/{episodeId}` 진입             |

---

## 화면 플로우

```
[방장 흐름]
S1 → S2 → S3 → S4 → S5 ─── (내 턴) ──→ S3 → S4 → S5
                              └── (AI 완성) → S7 → S4 → S8
                              └── (공유) → S8

[참여자 흐름]
공유 링크 → S6 → S5 ─── (내 턴) ──→ S3 → S4 → S5
                   └── (대기 중) → S5 계속

[구경꾼 흐름]
공유 링크 → S9 → "나도 이어쓰기" → S6 → S5
```

---

## S1 — 메인(랜딩)

```
┌──────────────────────────────────────┐
│  🎨 AI 릴레이 만화                   │  ← 로고/서비스명
│                                      │
│   그림 실력 없어도                    │
│   만화 작가가 될 수 있어요            │  ← 서브카피
│                                      │
│  ┌────────────────────────────────┐  │
│  │  + 새 만화 시작하기            │  │  ← Primary CTA
│  └────────────────────────────────┘  │
│                                      │
│  ── 최근 완성된 만화 ──              │
│  ┌──────┐ ┌──────┐ ┌──────┐        │
│  │ 썸네일│ │ 썸네일│ │ 썸네일│       │  ← 갤러리 (선택 기능)
│  │      │ │      │ │      │        │
│  └──────┘ └──────┘ └──────┘        │
└──────────────────────────────────────┘
```

**핵심 요소**
- "새 만화 시작하기" 버튼 1개
- 최근 공개 에피소드 갤러리 (MVP에서는 생략 가능)

---

## S2 — 에피소드 생성

```
┌──────────────────────────────────────┐
│  ← 뒤로                    1/2 단계 │  ← 진행 표시
├──────────────────────────────────────┤
│  스타일을 골라주세요                 │
│                                      │
│  ┌────────┐ ┌────────┐ ┌────────┐  │
│  │ [이미지]│ │ [이미지]│ │ [이미지]│ │
│  │ 웹툰   │ │ 4컷만화 │ │ 소녀만화│ │  ← 스타일 프리셋 6종
│  └────────┘ └────────┘ └────────┘  │  (선택 시 테두리 강조)
│  ┌────────┐ ┌────────┐ ┌────────┐  │
│  │ [이미지]│ │ [이미지]│ │ [이미지]│ │
│  │ 순정만화│ │ 개그만화│ │ 판타지 │ │
│  └────────┘ └────────┘ └────────┘  │
│                                      │
│  캐릭터를 설명해주세요               │
│  ┌────────────────────────────────┐  │
│  │ 예) 갈색 단발머리, 교복 입은   │  │  ← textarea
│  │ 17살 여고생. 밝고 엉뚱한 성격  │  │
│  └────────────────────────────────┘  │
│                                      │
│  제목 (선택)                         │
│  ┌────────────────────────────────┐  │
│  │                                │  │
│  └────────────────────────────────┘  │
│                                      │
│  한 줄 소개 (선택)                   │
│  ┌────────────────────────────────┐  │
│  │                                │  │
│  └────────────────────────────────┘  │
│                                      │
│  ┌────────────────────────────────┐  │
│  │      다음 → 첫 칸 그리기       │  │  ← 스타일 + 캐릭터 입력 시 활성화
│  └────────────────────────────────┘  │
└──────────────────────────────────────┘
```

**제약**
- 스타일 미선택 시 "다음" 버튼 비활성화
- 캐릭터 설명 미입력 시 "다음" 버튼 비활성화
- 스타일 선택 후 이후 변경 불가 (DB 저장 완료)

---

## S3 — 칸 입력

> 첫 칸 입력과 릴레이 중 차례 입력에 동일한 화면을 재사용

```
┌──────────────────────────────────────┐
│  ← 뒤로              칸 #3 작성 중  │  ← 현재 칸 번호
├──────────────────────────────────────┤
│  지금까지의 이야기                   │
│  ┌──────┐ ┌──────┐                 │
│  │ 칸 1 │ │ 칸 2 │  →              │  ← 이전 칸 썸네일 (가로 스크롤)
│  └──────┘ └──────┘                 │
├──────────────────────────────────────┤
│  장면 설명 *                         │
│  ┌────────────────────────────────┐  │
│  │ 예) 교실, 창문 옆 자리.        │  │
│  │ 민지가 책상에 엎드려 잠든 모습 │  │  ← 필수
│  └────────────────────────────────┘  │
│                                      │
│  대사                                │
│  ┌────────────────────────────────┐  │
│  │ 예) "아, 또 지각이잖아!"       │  │  ← 선택
│  └────────────────────────────────┘  │
│                                      │
│  표음                                │
│  ┌────────────────────────────────┐  │
│  │ 예) 쿵, 찌릿, 와르르           │  │  ← 선택
│  └────────────────────────────────┘  │
│                                      │
│  말풍선 위치                         │
│  ○ 왼쪽   ○ 오른쪽   ● 중앙        │  ← 라디오 버튼
│                                      │
│  ┌────────────────────────────────┐  │
│  │  ✨ 생성하기                   │  │  ← Primary, 장면설명 입력 시 활성화
│  └────────────────────────────────┘  │
└──────────────────────────────────────┘
```

**상태 분기**

| 상태 | "지금까지의 이야기" 영역 |
|------|--------------------------|
| 첫 칸 | 숨김 또는 "첫 장면을 그려볼까요?" 안내 문구 |
| 2칸 이상 | 이전 칸 썸네일 가로 스크롤 표시 |

---

## S4 — 생성 중 로딩

```
┌──────────────────────────────────────┐
│                                      │
│                                      │
│          ████████████░░░░            │  ← 프로그레스 바 (애니메이션)
│                                      │
│       AI가 칸을 그리는 중이에요...   │
│       잠시만 기다려 주세요           │
│                                      │
│   ─────────────────────────────────  │
│   이전 컷 썸네일 (흐리게 처리)       │
│   ┌──────┐ ┌──────┐ ┌──────┐       │
│   │ 칸 1 │ │ 칸 2 │ │  ??  │       │
│   └──────┘ └──────┘ └──────┘       │
│                                      │
│                                      │
└──────────────────────────────────────┘

[실패 시 오버레이]
┌──────────────────────────────────────┐
│   ⚠️  이미지 생성에 실패했어요       │
│   입력한 내용은 그대로 유지됩니다    │
│                                      │
│   ┌──────────┐   ┌─────────────┐   │
│   │  취소    │   │  다시 생성   │   │  ← 다시 생성 클릭 시 재호출
│   └──────────┘   └─────────────┘   │
└──────────────────────────────────────┘
```

**타임아웃 규칙**
- 30초 초과 → 실패 오버레이 자동 표시
- 입력값(장면·대사·표음) 유지

---

## S5 — 콜라보 대기실

> 방장·참여자 모두 동일 화면. 하단 입력 영역만 턴 상태에 따라 다름.

```
┌──────────────────────────────────────┐
│  🎨 교실의 비밀        [공유 링크 복사]│  ← 에피소드 제목 + 링크 복사 버튼
├──────────────────────────────────────┤
│  참여자                              │
│  👑 민지(나)   🟢 준호   ⬜ 수진     │  ← 아이콘: 왕관=방장, 초록=온라인, 흰=오프라인
│                                      │
│  지금은 준호님의 차례입니다 ⏳       │  ← 현재 턴 표시
├──────────────────────────────────────┤
│  만화 스트립                         │
│                                      │
│  ┌──────────────────────────────┐   │
│  │         칸 1 이미지          │   │
│  │                              │   │
│  └──────────────────────────────┘   │
│  ┌──────────────────────────────┐   │
│  │         칸 2 이미지          │   │  ← 세로 스트립 스크롤
│  │                              │   │
│  └──────────────────────────────┘   │
│  ┌──────────────────────────────┐   │
│  │         칸 3 이미지          │   │
│  │    ← 내 차례! 👇 입력하기    │   │  ← 내 턴일 때 강조
│  └──────────────────────────────┘   │
│                                      │
├──────────────────────────────────────┤
│  [내 턴 아닐 때 - 비활성]           │
│  ┌────────────────────────────────┐  │
│  │  준호님이 그리는 중입니다...   │  │  ← 회색, 비활성
│  └────────────────────────────────┘  │
│                                      │
│  [내 턴일 때 - 활성]                │
│  ┌────────────────────────────────┐  │
│  │  ✏️ 내 차례예요! 이야기를 이어주세요 →  │  ← 강조 색상, 클릭 시 S3으로
│  └────────────────────────────────┘  │
│                                      │
│  [3칸 이상 + 내 턴일 때 추가 표시]   │
│  ┌────────────────────────────────┐  │
│  │  🤖 AI에게 넘기기              │  │  ← Secondary, 3칸 미만 비활성
│  └────────────────────────────────┘  │
│                                      │
│  ┌────────────────────────────────┐  │
│  │  📤 지금 공유하기              │  │  ← 항상 표시
│  └────────────────────────────────┘  │
└──────────────────────────────────────┘
```

**Realtime 이벤트 처리**

| 이벤트 | UI 변화 |
|--------|---------|
| `panels` INSERT | 새 칸 스트립에 추가 (애니메이션) |
| `episodes.current_turn_index` UPDATE | 참여자 강조 표시 + 하단 입력 영역 전환 |
| 참여자 신규 JOIN | 참여자 칩 즉시 추가 |

---

## S6 — 닉네임 입력

> 공유 링크 `/c/{episodeId}` 진입 시 표시

```
┌──────────────────────────────────────┐
│                                      │
│         🎨 AI 릴레이 만화            │
│                                      │
│   "교실의 비밀" 만화에 초대되었어요! │  ← 에피소드 제목 표시
│                                      │
│   ┌──────┐ ┌──────┐ ┌──────┐       │
│   │ 칸 1 │ │ 칸 2 │ │ 칸 3 │       │  ← 현재까지의 칸 미리보기 (최대 3칸)
│   └──────┘ └──────┘ └──────┘       │
│                                      │
│   닉네임을 입력해주세요              │
│   ┌────────────────────────────────┐ │
│   │                                │ │  ← 최대 10자
│   └────────────────────────────────┘ │
│   회원가입 없이 바로 참여할 수 있어요│
│                                      │
│   ┌────────────────────────────────┐ │
│   │       참여하기 →               │ │  ← 닉네임 입력 시 활성화
│   └────────────────────────────────┘ │
│                                      │
│   그냥 구경만 할게요 →              │  ← S9(뷰어)로 이동
└──────────────────────────────────────┘
```

---

## S7 — AI 이어쓰기 확인

> "AI에게 넘기기" 클릭 후 바텀시트 또는 모달

```
┌──────────────────────────────────────┐
│  AI가 이야기를 완성해드릴게요! 🤖    │
├──────────────────────────────────────┤
│  지금까지 3칸을 작성했어요.          │
│                                      │
│  몇 칸을 더 완성할까요?              │
│                                      │
│     ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐  │
│     │ 1 │ │ 2 │ │ 3 │ │ 5 │ │10 │  │  ← 칸 수 선택 버튼
│     └───┘ └───┘ └───┘ └───┘ └───┘  │
│            ↑ 선택된 칸 수 강조       │
│                                      │
│  총 8칸짜리 만화가 완성돼요          │  ← 현재 칸 + 선택한 칸 수 합산 안내
│                                      │
│  ┌──────────┐   ┌─────────────────┐ │
│  │  취소    │   │ ✨ AI에게 맡기기 │ │
│  └──────────┘   └─────────────────┘ │
└──────────────────────────────────────┘
```

**처리 흐름**
1. 확인 클릭 → Gemini 2.5 Flash API로 스토리 생성 요청
2. 스토리 응답 수신 → 칸별 순차적으로 S4(로딩) 반복
3. 모든 칸 완성 → S5 복귀 (스트립 전체 표시)

---

## S8 — 공유

> "지금 공유하기" 클릭 후 바텀시트

```
┌──────────────────────────────────────┐
│  완성된 만화를 공유해보세요! 📤      │
├──────────────────────────────────────┤
│  미리보기                            │
│  ┌──────────────────────────────┐   │
│  │                              │   │
│  │    세로 스트립 전체 미리보기  │   │  ← 썸네일 (스크롤 가능)
│  │    (칸 1 ~ 칸 N)             │   │
│  │                              │   │
│  └──────────────────────────────┘   │
│                                      │
│  ┌────────────────────────────────┐  │
│  │  📥 이미지 저장 (PNG)          │  │  ← 클릭 시 세로 스트립 다운로드
│  └────────────────────────────────┘  │
│                                      │
│  ┌────────────────────────────────┐  │
│  │  🔗 링크 복사                  │  │  ← 클릭 시 "/e/{episodeId}" 복사 + 토스트
│  └────────────────────────────────┘  │
│                                      │
│  (선택) QR 코드 보기                 │  ← 접기/펼치기
│                                      │
│  닫기                                │
└──────────────────────────────────────┘
```

**토스트 메시지**
- 링크 복사 성공: "링크가 복사되었어요!"
- 이미지 저장 완료: "이미지가 저장되었어요!"

---

## S9 — 감상(뷰어)

> 공유 링크 `/e/{episodeId}` 진입 시. 로그인 불필요.

```
┌──────────────────────────────────────┐
│  ← 홈                   [공유 링크] │
├──────────────────────────────────────┤
│  🎨 교실의 비밀                      │  ← 에피소드 제목
│  민지 · 준호 · 수진 · AI 완성       │  ← 참여자 목록
│  ♥ 42                               │  ← 에피소드 총 좋아요 (칸별 합산)
├──────────────────────────────────────┤
│                                      │
│  ┌──────────────────────────────┐   │
│  │         칸 1 이미지          │   │
│  │                     ♥ 12    │   │  ← 칸별 좋아요 버튼
│  └──────────────────────────────┘   │
│                                      │
│  ┌──────────────────────────────┐   │
│  │         칸 2 이미지          │   │
│  │                     ♥  8    │   │
│  └──────────────────────────────┘   │
│                                      │
│          ...  (세로 스크롤)          │
│                                      │
│  ┌──────────────────────────────┐   │
│  │         칸 N 이미지          │   │
│  │                     ♥ 22    │   │
│  └──────────────────────────────┘   │
│                                      │
├──────────────────────────────────────┤
│  ┌────────────────────────────────┐  │
│  │  ✏️ 나도 이어쓰기              │  │  ← in_progress 에피소드만 표시
│  └────────────────────────────────┘  │
│  ┌────────────────────────────────┐  │
│  │  📤 공유하기                   │  │
│  └────────────────────────────────┘  │
└──────────────────────────────────────┘
```

**상태별 하단 CTA**

| 에피소드 상태 | 표시 버튼 |
|---------------|-----------|
| `in_progress` | "나도 이어쓰기" + "공유하기" |
| `completed`   | "공유하기"만 표시 |

---

## 컴포넌트 공통 규칙

### 토스트 / 인라인 에러

```
┌─────────────────────────────┐
│  ⚠️ 잠시 후 다시 시도해주세요 │   ← 화면 상단 고정, 3초 후 자동 닫힘
└─────────────────────────────┘
```

### 생성 중 칸 플레이스홀더

```
┌──────────────────────────────┐
│                              │
│    ░░░░░░░░░░░░░░░░░░░░░░    │  ← 스켈레톤 UI (펄스 애니메이션)
│    ░░░░░  생성 중...  ░░░░   │
│    ░░░░░░░░░░░░░░░░░░░░░░    │
│                              │
└──────────────────────────────┘
```

---

## 마일스톤별 화면 구현 순서

| 마일스톤 | 화면 |
|----------|------|
| M2 (단일 유저) | S1 → S2 → S3 → S4 → S5(스트립 뷰만) |
| M3 (콜라보)   | S6 추가, S5 Realtime 연결 |
| M4 (AI + 공유) | S7, S8 추가 |
| M5 (데모 완성) | S9, 에러/토스트, 좋아요 |
